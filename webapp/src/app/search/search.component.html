<sbdl-text-field
  (submit)="search({query: $event})"
  [model]="filters.query"
  placeholder="What are you looking for? (e.g., fractions, Grade 6 playlist)"
  fontAwesomeIcon="fa-search">
</sbdl-text-field>

<div *ngIf="!showingResults" class="emphasis-medium caption browse-caption">
  Start typing a topic, claim, target, or <a href="javascript:void(0)" (click)="showAdvanced = true">browse for resources</a>.
</div>
<div *ngIf="showingResults" class="emphasis-medium caption filters-caption">
  Start typing a topic, claim, target, or <a href="javascript:void(0);" (click)="showAdvanced = true">advanced search</a>.
</div>

<h4 *ngIf="showingResults" class="results-header">
  <span>
    Found {{ numResults }}
    <ng-container [ngPlural]="numResults" >
      <ng-template ngPluralCase="=0">resources for "{{filters.query}}"</ng-template>
      <ng-template ngPluralCase="=1">resource</ng-template>
      <ng-template ngPluralCase="other">resources</ng-template>
    </ng-container>
  </span>
  <sbdl-button class="plain"
               (click)="goToResults.emit(true)"
               *ngIf="showAdvanced && numResults > 0">
    scroll to results <i class="far fa-arrow-down" aria-hidden="true"></i>
  </sbdl-button>
</h4>

<div [hidden]="!showAdvanced || numResults === 0" class="advanced-search">
  <div class="loading-overlay" [ngClass]="{loading: loading}">
    <div>Loading...</div>
  </div>
  <div class="advanced-header">
      <h5 *ngIf="!showingResults">Browse for Resources</h5>
      <h5 *ngIf="showingResults">Advanced Search</h5>
      <div>
        <a [routerLink]="['/search', {query: filters.query || ''}]"
           class="emphasis-medium caption">
          <i class="fa fa-undo" aria-hidden="true"></i> Clear Filters
        </a>
        <a href="javascript:void(0)" class="emphasis-medium caption" (click)="showAdvanced = false">
          <sbdl-icon icon="close" aria-label="Close advanced filters"></sbdl-icon>
        </a>
      </div>
  </div>
  <div class="filter-container"
       *ngIf="filters.resourceTypes.length > 0">
    <h6>Select a type</h6>
    <sbdl-filter-chipset
      [filters]="filters.resourceTypes"
      (onChanged)="search({resourceTypes: $event.join(',')})"
    ></sbdl-filter-chipset>
  </div>
  <div class="filter-container"
       *ngIf="filters.grades.length > 0">
    <h6>Grades</h6>
    <sbdl-filter-chipset
      [filters]="filters.grades"
      (onChanged)="search({grades: $event.join(',')})"
      ></sbdl-filter-chipset>
  </div>
  <div class="filter-container"
       *ngIf="filters.subjects.length > 0">
    <h6>Subjects</h6>
    <sbdl-filter-chipset
      [filters]="filters.subjects"
      (onChanged)="search({subjects: $event.join(',')})"
    ></sbdl-filter-chipset>
  </div>
  <div class="filter-container"
       *ngIf="filters.claims.length > 0">
    <h6>Claims</h6>
    <sbdl-filter-chipset
      *ngIf="params.subjects && params.grades; else displayClaimsMessage"
      [filters]="filters.claims"
      (onChanged)="search({claims: $event.join(',')})"
    ></sbdl-filter-chipset>
    <ng-template #displayClaimsMessage>
      <p class="body-2 emphasis-medium fallback-message">
        Select a <b>Grade</b> and a <b>Subject</b> to view Claim options
      </p>
    </ng-template>
  </div>
  <div class="filter-container"
       *ngIf="filters.targets.length > 0">
    <h6>Targets</h6>
    <sbdl-filter-chipset
      *ngIf="params.subjects && params.grades && params.claims; else displayTargetMessage"
      [filters]="filters.targets"
      (onChanged)="search({targets: $event.join(',')})"
    ></sbdl-filter-chipset>
    <ng-template #displayTargetMessage>
      <p class="body-2 emphasis-medium fallback-message">
        Select a <b>Grade</b>, <b>Subject</b>, and a <b>Claim</b> to view Target options
      </p>
    </ng-template>
  </div>
  <div class="filter-container"
       *ngIf="filters.standards.length > 0">
    <h6>Content Standards</h6>
    <sbdl-filter-chipset
      *ngIf="params.subjects && params.grades && params.claims; else displayStandardsMessage"
      [filters]="filters.standards"
      (onChanged)="search({standards: $event.join(',')})"
    ></sbdl-filter-chipset>
    <ng-template #displayStandardsMessage>
      <p class="body-2 emphasis-medium fallback-message">
        Select a <b>Grade</b>, <b>Subject</b>, and a <b>Claim</b> to view
        Content Standard options
      </p>
    </ng-template>
  </div>
</div>
